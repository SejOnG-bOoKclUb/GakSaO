# 4장. 역할, 책임, 협력

✅ 책임

- 책임을 어떻게 구현할 것인가 하는 문제는 객체와 책임이 제자리를 잡은 후에 고려해야 한다.
즉, 책임을 먼저 생각하고, 구현을 들어가야 한다는 것이다.
- 책에서는 책임을 2가지로 분류하고 있다. 하는 것(doing)과 아는 것(knowing)이다. 
조금 풀어서 말하면 아는 것은 객체의 외부에 제공해 줄 수 있는 정보이고,  하는 것은 외부에 제공해줄 수 있는 서비스의 목록이다.

> 역할, 책임, 협력 다 알겠어. 객체는 3가지를 가지면 된다는 거지?
> 
- ~~그렇다. 하지만, 사고의 흐름이 중요하다.~~
- ~~객체의 역할을 먼저 생각하고 책임과 협력을 생각하는 것과, 책임과 역할을 생각하고 역할을 생각하는 것에는 차이가 있다.~~
- ~~책에서 예를 들어준 것처럼 ,
“재판이라는 협력에 참여하기 위해 왕과 모자 장수가 상호 협력해야 하고, 이를 위해 증언하라 라는 메시지를 송신하고 수신할 수 있다는 것을 결정하는 것이 중요하다. 그러고 나서 모자 장수가 어떻게 증언할 것인지 고민해야 한다.”~~
- **따라서, 우선 객체가 어떤 책임을 가지고, 어떤 방식으로 협력하는지를 먼저 잡는다. 그리고 나서 어떤 클래스와 협력하고 어떤 메서드를 포함(역할)하는지를 결정하라는 것이다.**

✅ 역할

- 단순성 == 추상화
- 유연성 == 다양한 객체들이 협력에 참여 가능
- 재사용성 == 다양한 객체들이 동일한 협력에 참여 가능

✅ 협력

협력을 따라 흐르는 객체의 책임

협력을 설계한다? → 협력에 참여하는 객체들이 주고받을 요청과 응답의 흐름을 결정한다.

**어떤 객체가 어떤 요청을 받았을 때 어떤 응답을 할 지를 결정하다 보면 그것이 객체의 책임이다.**

그러고 나서 행동을 정의한다.

협력 → 책임 → 행동

☑️ 객체지향 설계 기법

- 책임-주도 설계
    - 시스템이 사용자에게 제공해야 하는 기능인 시스템 책임을 파악한다.
    - 시스템 책임을 더 작은 책임으로 분할한다.
    - 분할된 책임을 수행할 수 있는 적절한 객체 또는 역할을 찾아 책임을 할당한다.
    - 객체가 책임을 수행하는 중에 다른 객체의 도움이 필요한 경우 이를 책임질 적절한 객체 또는 역할을 찾는다.
    - 해당 객체 또는 역할에게 책임을 할당함으로써 두 객체가 협력하게 된다.
- 디자인 패턴
- 테스트-주도 계발
    - 단순히 로직이 잘 동작하는지 테스트하는 것은 보너스 이며,
    - 실제 목적은 구체적인 코드를 작성해나가면서 역할, 책임, 협력을 식별하고 식별된 역할, 책임, 협력이 적합한지를 피드백받는 것이다.
    - 책임을 수행할 객체 또는 클라이언트가 기대하는 객체의 역할이 메시지를 수신할 때 어떤 결과를 반환하고 그 과정에서 어떤 객체와 협력할 것인지에 대한 기대를 코드의 형태로 작성하는 것
    - 여기서 우리가 우테코 과제를 수행하며 테스트 코드를 작성했던 것을 생각해보자. 테스트 코드를 작성해야하는데 해당 로직에 대해서는 어딘가 막혀서 테스트를 할 수 없었던 경험이 있을 것이다. 나는 그런 경험이 있다. 이런 경험을 바탕으로 바로 위의 글을 다시 읽으니 아주 공감이 됐다.

# 5장. 책임과 메시지

### 자율적인 책임

어떠한 요청을 받았으면, 해당 요청에 대한 응답은 그 객체가 판단하는 것이다.

모자 장수에게 ‘증언하라’는 요청을 전송하면 모자장수는 자기가 원하는 대로 증언을 하면된다.

하지만, ‘언제’ , ‘어디서’ 등등 구체적으로 요청을 한다면 자율성을 제한하게 된다는 것이다.

### 너무 추상적인 책임

그렇다고 너무 추상적이게 해서는 안된다. 요청을 받은 객체가 어떤 책임을 가지고 응답을 해야하는지 알 수 없기 때문이다. 

모자 장수에게 그냥 ‘설명하라’ 던져놓으면 모호해진다.

### What/Who

객체 사이 협력 관계를 설계하기 위해서는 ‘어떤 행위(what)’을 수행할 것인지를 결정한 후 ‘누가(who)’ 그 행위를 구행할 것인지를 결정해야 한다. 

여기서 ‘어떤 행위’는 메시지를 의미한다.

객체의 행위를 결정하는 것은 객체 자체의 속성이 아니다. 어떤 특성을 가지고 있다 해서 반드시 관련된 행위를 수행할 것이라고 가정하지 않는다.

### Tell, Don’t Ask

묻지 말고 시켜라. 즉, 내가 어떤 행위를 하려고 할 때 필요한 정보가 있다면 묻지말고 시켜라는 뜻이다. 

잊혀져가는 우리 성민이가 우테코 과제를 할 때, getter를 어떻게 할 지 모르겠다고 하니까 이렇게 말하고 떠났다. ‘Tell, Don’t Ask…’ 그래서 이 주제를 보자마자 getter가 바로 생각났다.

호기가 말했듯이 이름표를 뜯어와서 내가 직접 보느냐와 넌 이름이 뭐니? 라고 묻는 것에 차이가 있는 것이다.

이렇게 하면 각자의 책임을 다하면서 캡슐화를 지킬 수 있다.

### 인터페이스

메시지가 인터페이스를 결정한다. 객체가 어떤 메시지를 수신할 수 있는지가 객체가 제공하는 인터페이스의 모양을 빚는다.

‘증언하라’라는 메시지를 수신받는 다양한 책임을 가진 객체들이 있을 것이고 그것은 곧 메시지를 수신할 수 있는 인터페이스가 존재한다는 것을 알 수 있다. 

### 객체관점에서 생각하는 인터페이스

- 좀 더 추상적인 인터페이스 - 너무 구체적이면 자율성을 보장x
- 최소 인터페이스 - 외부로 유출 최소화 [메시지를 따르라]
- 인터페이스와 구현 간에 차이가 있다는 점을 인식